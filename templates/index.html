<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Excel Comparison Tool</title>

    <!-- Bootstrap & Icons -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
      rel="stylesheet"
    />

    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/styles.css') }}"
    />
  </head>

  <body>
    <!-- Sidebar -->
    <div class="sidebar">
      <div>
        <div class="logo">
          <img
            src="{{ url_for('static', filename='images/desktop-app-logo.png') }}"
            alt="Logo"
          />
          <h3>Excel Comparison</h3>
        </div>

        <!-- Upload Form -->
        <!-- method="POST" -->
        <form
          enctype="multipart/form-data"
          method="post"
          action="/process"
          id="uploadForm"
          class="mt-4"
        >
          <div id="filePairs">
            <div class="card pair-card shadow-sm p-3">
              <div class="mb-3">
                <label class="form-label fw-semibold text-secondary"
                  >Actual File:</label
                >
                <input
                  type="file"
                  name="actual_0"
                  class="form-control"
                  accept=".xlsx, .xls"
                  required
                />
              </div>
              <div class="mb-3">
                <label class="form-label fw-semibold text-secondary"
                  >Expected File:</label
                >
                <input
                  type="file"
                  name="expected_0"
                  class="form-control"
                  accept=".xlsx, .xls"
                  required
                />
              </div>
              <div class="text-end">
                <button
                  type="button"
                  class="btn btn-danger btn-sm remove-btn"
                  disabled
                >
                  <i class="fas fa-trash-alt"></i>
                </button>
              </div>
            </div>
          </div>

          <div class="text-center mt-3">
            <button
              type="button"
              id="addRow"
              class="btn btn-outline-primary btn-sm me-2"
            >
              <i class="fas fa-plus-circle"></i> Add Pair
            </button>
            <button
              type="submit"
              class="btn btn-success btn-sm"
              onclick="handleSubmit(event)"
            >
              <i class="fas fa-check-circle"></i> Compare
            </button>
          </div>
        </form>
      </div>

      <footer>
        © {{ current_year }} — <strong>Sajjad Ali</strong><br />
        Flask + Bootstrap 5
      </footer>
    </div>

    <!-- Main Content -->
    <div class="main">
      <!-- Header -->
      <div class="app-header text-center mb-4">
        <img
          src="{{ url_for('static', filename='images/login-banner.png') }}"
          alt="Excel Comparison Banner"
        />
        <h1><i class="fas fa-file-excel me-2"></i>Excel Comparison Tool</h1>
        <hr
          class="border-light opacity-25"
          style="width: 60%; margin: 1.5rem auto"
        />

        <p class="text-light small mb-0">
          Designed for financial model validation, data audits, and
          reconciliation workflows.
        </p>
        <hr
          class="border-light opacity-25"
          style="width: 60%; margin: 1.5rem auto"
        />

        <div
          class="description-box text-light rounded-3 p-2 shadow-sm mx-auto"
          style="max-width: 700px"
          onclick="toggleDescription()"
        >
          <p id="toolDesc" class="mb-0 text-white-50 fs-5 d-inline">
            This tool automatically compares two Excel workbooks
            <button
              class="btn btn-link text-white-50 p-0 ms-1 align-baseline"
              onclick=""
              title="Show more details"
              style="text-decoration: none"
            >
              <i class="fas fa-chevron-down"></i>
            </button>
          </p>
        </div>
      </div>

      <!-- Loader -->
      <div id="loader" class="text-center my-5" style="display: none">
        <div class="spinner-border text-primary" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
        <p class="mt-3 text-secondary">Comparing files, please wait...</p>
      </div>

      <!-- Results -->
      <div id="results-section" class="results-section mt-4"></div>
    </div>

    <!-- JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/js/all.min.js"></script>
    <script src="{{ url_for('static', filename='js/scripts.js') }}"></script>
  </body>
</html>
